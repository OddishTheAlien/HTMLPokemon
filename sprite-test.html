<html>
    <head>
        <title>Sprite Test</title>
        <link rel="icon" href="favicon.ico">
        <script src="utility.js" type="text/javascript"></script>
        <script src="jquery-3.2.1.js" type="text/javascript"></script>
        <script src="canvas.js" type="text/javascript"></script>
        <script src="point.js" type="text/javascript"></script>
        <script src="vector.js" type="text/javascript"></script>
        <script src="segment.js" type="text/javascript"></script>
        <script src="rectangle.js" type="text/javascript"></script>
        <script src="spritesheet.js" type="text/javascript"></script>
        <script src="sprite.js" type="text/javascript"></script>
        <script src="spriteData.js" type="text/javascript"></script>
        <script src="animate.js" type="text/javascript"></script>
        <script src="maps.js" type="text/javascript"></script>
        <script src="world.js" type="text/javascript"></script>
        <script src="dialog.js" type="text/javascript"></script>
        <script src="keyboard.js" type="text/javascript"></script>
        <script src="mouse.js" type="text/javascript"></script>
        <script src="event.js" type="text/javascript"></script>
        
        <script language = "javascript">
            
            var Context = null;
            var framerate = 24;
            
            var canvasWidth = 800;
            var canvasHeight = 600;
            
            var sunset = new Sprite("Panorama/sunset1.png", 320, 240, 1, 1);
            
            // Edit size parameter: Width, Height, numberSpritesX, numberSpritesY
            var sprite_test = new Sprite("CharSet/test_sprite.png", 320, 363, 3, 1);
            
            var collision = false;
            
            var mouse_x = 0;
            var mouse_y = 0;
            
            var charX = [200, 100];
            var charY = [100, 100];
            
            var prevX = 0;
            var prevY = 0;
            
            $(document).ready(function() {
                
                Context = new HTML("game", canvasWidth, canvasHeight);
                
                // Easy access to grafics (gfx)
                window.gfx = Context.context;
                
                InitializeKeyboard();
                
                DisableScrollbar();
                
                InitalizeAnimationCounters();
            });
            
            $(window).on('load', function () { });
            
            setInterval(function() {
                // Background: TODO: Implement moving background
                // Stretch panorama to canavas size for a background
                sunset.draw2(0, 0, canvasWidth, canvasHeight);

                ResetAnimationCounter();
                character_is_moving = false;                
                
                // <if else> for four direction movement
                if (motionEnabled) {
                    if (key.up || key.w) {
                        charY[mapID] -= speed;
                        if (charY[mapID] < -16) {
                            charY[mapID] = -16;
                        }
                        character_is_moving = true;
                    }
                    if (key.down || key.s) {
                        charY[mapID] += speed;
                        if (charY[mapID] > canvasHeight-32) {
                            charY[mapID] = canvasHeight-32;
                        }
                        character_is_moving = true;
                    }
                    if (key.left || key.a) {
                        charX[mapID] -= speed;
                        if (charX[mapID] < -4) {
                            charX[mapID] = -4;
                        }
                        character_is_moving = true;
                    }
                    if (key.right || key.d) {
                        charX[mapID] += speed;
                        if (charX[mapID] > canvasWidth-20) {
                            charX[mapID] = canvasWidth-20;
                        }
                        character_is_moving = true;
                    }
                }               
                
                // Animated characters
                var char_seq = 0;
                
                if (character_is_moving) {
                    // Edit move sequence
                    char_seq = [0,1,2];
                    
                    sprite_test.draw(charX[mapID], charY[mapID], char_seq);
                }
                else
                    sprite_test.draw(charX[mapID], charY[mapID], 0);
                
                
            }, framerate);
        
        </script>
    </head>


    <body>
        
        <canvas id="game"></canvas>
        
    </body>    
</html>