<html>
    <head>
        <title>RPG GAME</title>
        <link rel="icon" href="favicon.ico">
        <script src="utility.js" type="text/javascript"></script>
        <script src="jquery-3.2.1.js" type="text/javascript"></script>
        <script src="canvas.js" type="text/javascript"></script>
        <script src="maps.js" type="text/javascript"></script>
        <script src="animate.js" type="text/javascript"></script>
        <script src="spritesheet.js" type="text/javascript"></script>
        <script src="sprite.js" type="text/javascript"></script>
        <script src="world.js" type="text/javascript"></script>
        <script src="dialog.js" type="text/javascript"></script>
        <script src="keyboard.js" type="text/javascript"></script>
        <script src="mouse.js" type="text/javascript"></script>
        <script src="event.js" type="text/javascript"></script>
        <script src="point.js" type="text/javascript"></script>
        <script src="vector.js" type="text/javascript"></script>
        <script src="segment.js" type="text/javascript"></script>
        <script src="rectangle.js" type="text/javascript"></script>
        
        <script language = "javascript">
            
            var Context = null;
            var framerate = 24;
            
            var canvasWidth = 480;
            var canvasHeight = 360;
            
            var panorama = new Sprite("Panorama/AngrySheeps.jpg", 320, 240, 1, 1);
            var bananaphone = new Sprite("FaceSet/bananaphone.png");
            var forest = new Sprite("FaceSet/forest.png");
               
            var audio1 = new Audio('Music/banana-phone.ogg');
            var audio2 = new Audio('Music/forest.ogg');
            
            var mouse_x = 0;
            var mouse_y = 0;
            
            $(document).ready(function() {
                
                Context = new HTML("game", canvasWidth, canvasHeight);
                
                // Easy access to grafics (gfx)
                window.gfx = Context.context;
                
                InitializeKeyboard();
                
                InitalizeAnimationCounters();
                
                InitalizeMouse();
                
            });
            
            $(window).on('load', function () {});
            
            setInterval(function() {
                
                ResetAnimationCounter();
                
                // Layer 0: Panorama
                // Background: TODO: Implement moving background
                // Stretch panorama to canavas size for a background
                panorama.draw2(0, 0, canvasWidth, canvasHeight);
                
                // Layer 1: Walkable ground 
                DrawBackgroundMap();
                
                // Layer 2: Objects on the ground below Layer 3
                //TODO: add in world.js
                
                // Layer 3: character & objects
                
                // Collison Box of the character
                var char_collision_box = new Rectangle(char_x, char_y, character.spriteWidth, character.spriteWidth);
                
                // Rectangle 1 blue
                var rect1 = new Rectangle(100, 100, 10, 10);
                rect1.draw('blue', true, 'blue',false);
                // Rectangle-Char-Collision
                if (char_collision_box.rectInside(rect1)) {
                    rect1.draw('red',true,'red',false);
                    DrawDialog("bananaphone", bananaphone);
                    audio1.play();
                }
                else
                    audio1.pause();
                // Rectangle 2 green
                var rect2 = new Rectangle(200, 100, 10, 10);
                rect2.draw('green',true,'green',false);
                // Rectangle-Char-Collision
                if (char_collision_box.rectInside(rect2)) {
                    rect2.draw('yellow',true,'yellow',false);
                    DrawDialog("forest", forest);
                    audio2.play();
                }
                else
                    audio2.pause();
                
                
                var mouseRect = new Rectangle(mouse_x, mouse_y, character.spriteWidth, character.spriteHeight);
                mouseRect.draw('white', false, 'black',true);
                
                // Draws motion of moveable objects
                DrawEvents();
                
                //DrawDialog();
                
                // Layer 4: Objects over Layer 3 - i.e. stand behind a tree
                // TODO: add in world.js

                
            }, framerate);
        
        </script>
        
    </head>


    <body>
        <h1 id="title" >game.html</h1>
        
        <p>
            Clicking on the game disables scrolling for this website. Press "Esc" to enable it again.
            
            <button onclick="enterFullscreen(document.getElementById('game'))" id="exit">Fullscreen</button>
        </p>
        
        <p>
            WASD or Arrow-Key: Character Control; Click: Moves Character to Mouse; +/-: Speed Up/Down
        </p>
        
        <p>
            Press Enter to see a dialog.        
        </p>
    
        <canvas id="game"></canvas>
        
    </body>    
</html>